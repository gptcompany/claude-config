version: '1.0'
updated: '2026-01-09'
infrastructure:
  questdb:
    host: localhost
    http_port: 9000
    ilp_port: 9009
    pg_port: 8812
  redis:
    host: localhost
    port: 6379
  hooks_shared:
    path: /media/sam/1TB/claude-hooks-shared
  # Monitoring is in nautilus_dev but serves ALL projects (shared infra)
  monitoring:
    path: /media/sam/1TB/nautilus_dev/monitoring
    grafana_port: 3000
    dashboards: /media/sam/1TB/nautilus_dev/monitoring/grafana/dashboards
    alerts: /media/sam/1TB/nautilus_dev/monitoring/grafana/provisioning/alerting
    prometheus_port: 9090
    cadvisor_port: 8484
  # Expected services for infrastructure health monitoring
  expected_services:
    systemd:
      critical:
        - name: grafana-server
          port: 3000
        - name: prometheus
          port: 9090
        - name: node_exporter
          port: 9100
        - name: process-exporter
          port: 9256
        - name: docker
        - name: bitcoind
          port: 8333
      important:
        - name: research-events
        - name: cloudflared
        - name: ollama
    docker:
      critical:
        - name: nautilus-questdb
          ports: [9000, 9009, 8812]
        - name: nautilus-redis
          ports: [6379]
      important:
        - name: n8n-n8n-1
          ports: [5678]
        - name: neo4j-research
          ports: [7474, 7687]
        - name: mempool-api
          ports: [8999]
        - name: mempool-web
          ports: [8080]
        - name: claude-reflection-qdrant
          ports: [6333]
        - name: influxdb-production
          ports: [8086]
      optional:
        - name: nautilus-github-runner
        - name: n8n-n8n-worker-1
        - name: n8n-postgres-1
        - name: n8n-redis-1
        - name: mempool-electrs
        - name: mempool-db
        - name: phoenix-phoenix-1
        - name: phoenix-postgres-1
        - name: claude-reflection-mcp
    cron:
      - name: utxoracle_daily
        schedule: "*/10 * * * *"
        command: /media/sam/1TB/UTXOracle/scripts/daily_analysis.py
        log: /tmp/daily_analysis_cron.log
        severity: high
      - name: weekly_scrape
        schedule: "0 3 * * 0"
        command: /media/sam/1TB/UTXOracle/scripts/bootstrap/run_weekly_scrape.sh
        severity: medium
      - name: nautilus_update
        schedule: "0 7 * * *"
        command: /media/sam/1TB/nautilus_dev/scripts/auto_update/run_update.sh
        severity: medium
    ports:
      critical:
        3000: grafana
        9000: questdb-http
        9009: questdb-ilp
        8812: questdb-pg
        6379: redis
        9090: prometheus
        8333: bitcoind
      important:
        5678: n8n
        7474: neo4j-http
        7687: neo4j-bolt
        8080: mempool-web
        8999: mempool-api
        6333: qdrant
        8086: influxdb
      monitoring:
        9100: node_exporter
        9256: process_exporter
        8484: cadvisor
repositories:
  nautilus_dev:
    path: /media/sam/1TB/nautilus_dev
    language: python
    framework: nautilustrader
    test_command: uv run pytest tests/ -x
    lint_command: uv run ruff check .
    format_command: uv run ruff format .
    features:
    - trading_strategies
    - backtesting
    - live_trading
  n8n_dev:
    path: /media/sam/1TB/N8N_dev
    language: typescript
    framework: n8n
    test_command: npm test
    lint_command: npm run lint
    features:
    - workflow_automation
    - integrations
  utxoracle:
    path: /media/sam/1TB/UTXOracle
    language: python
    framework: fastapi
    test_command: uv run pytest tests/ -x
    lint_command: uv run ruff check .
    features:
    - bitcoin_analytics
    - utxo_analysis
  liquidation_heatmap:
    path: /media/sam/1TB/LiquidationHeatmap
    language: python
    framework: flask
    test_command: uv run pytest tests/ -x
    lint_command: uv run ruff check .
    features:
    - market_visualization
    - liquidation_data
global:
  commands:
  - tdd/
  - undo/
  - speckit.analyze
  - speckit.checklist
  - speckit.clarify
  - speckit.constitution
  - speckit.implement
  - speckit.plan
  - speckit.specify
  - speckit.tasks
  - speckit.taskstoissues
  skills:
  - pytest-test-generator
  - pydantic-model-generator
  - github-workflow
  - metrics-insight
  hooks:
    pre_tool_use:
    - context_bundle_builder.py
    - smart-safety-check.py (Bash)
    - git-safety-check.py (Bash)
    - tdd-guard-check.py (Write|Edit)
    - agent-spawn-tracker.py (Task)
    post_tool_use:
    - post-tool-use.py
    - dora-tracker.py
    - auto-format.py (Write|Edit)
    - architecture-validator.py (Bash)
    stop:
    - stop.py
    - context-preservation.py
    - session-summary.py
    - auto-ralph.py
    - ralph-loop.py
    subagent_stop:
    - subagent-checkpoint.sh
    user_prompt_submit:
    - task-classifier-v2.py
    - ssot_check.py
    - ralph-resume.py
    - verbalized_sampling.py
  utility_scripts:
    drift_detector:
      path: ~/.claude/scripts/drift-detector.py
      description: Check for config drift across repositories
      checks: [duplicates, missing_files, settings_drift, obsolete, ports, services, containers, cron]
    weekly_health_report:
      path: ~/.claude/scripts/weekly-health-report.sh
      description: Send health report to Discord
      schedule: "0 8 * * 1"  # Every Monday 8:00 AM
    system_state_snapshot:
      path: ~/.claude/scripts/system-state-snapshot.sh
      description: Capture system configuration for disaster recovery
      usage: --save to persist, --save --push to push to git
    backup_validator:
      path: ~/.claude/scripts/backup-validator.sh
      description: Verify GitHub backups are recent and complete
      usage: --fix to push unpushed changes
project_specific:
  nautilus_dev:
    skills:
    - paper-to-strategy
    - formula-to-code
    commands:
    - research.md
    - optimize.md
    - pinescript.md
    agents:
    - nautilus-coder
    - nautilus-docs-specialist
    - backtest-analyzer
  utxoracle:
    skills:
    - bitcoin-rpc-connector
metrics:
  schema: ~/.claude/schemas/metrics.yaml
  tables:
  - claude_tool_usage
  - claude_events
  - claude_sessions
  - claude_agents
  - claude_hooks
  - claude_tasks
  - claude_context
  retention:
    default: 90d
    sessions: 365d
    hooks: 30d
reports:
  daily:
    period: 24h
    sections:
    - summary
    - errors
    - top_issues
    output: terminal
  weekly:
    period: 7d
    sections:
    - summary
    - trends
    - agent_performance
    - recommendations
    output: markdown
  monthly:
    period: 30d
    sections:
    - summary
    - cost_analysis
    - trends
    - agent_roi
    - recommendations
    - next_actions
    output: markdown
thresholds:
  hook_latency_warn_ms: 100
  hook_latency_critical_ms: 500
  agent_success_rate_min: 0.8
  daily_cost_warn_usd: 30
  daily_cost_critical_usd: 50
  context_utilization_warn: 0.8
features:
  self_healing_hooks:
    enabled: true
    max_failures: 3
    failure_window_seconds: 300
    disable_duration_seconds: 3600
    state_file: ~/.claude/metrics/hook_health.json
  cost_attribution:
    enabled: true
    by_project: true
    by_branch: true
    by_task_type: true
    task_types:
    - feature
    - bugfix
    - refactor
    - testing
    - docs
  optimization_tips:
    enabled: true
    tips_file: ~/.claude/metrics/last_session_tips.json
    command: /tips  # Manual command, user decides when to view/use
sync:
  global_to_project:
  - commands/tdd/
  - commands/undo/
  - skills/pytest-test-generator/
  - skills/pydantic-model-generator/
  - skills/github-workflow/
  project_only:
  - CLAUDE.md
  - settings.local.json
  - agents/
  consistency_check:
  - hooks configuration in settings.json
  - env variables (QUESTDB_HOST, etc.)
