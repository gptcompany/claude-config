# Trivy Ignore File for {{ project_name }}
# Generated by validation-framework
#
# Format:
#   CVE-XXXX-YYYY: Justification why this is acceptable
#   CVE-XXXX-YYYY
#
# Best practices:
#   - Always document WHY a CVE is being ignored
#   - Review ignored CVEs periodically (monthly recommended)
#   - Link to internal ticket/issue when possible
#   - Consider time-boxing ignores with review dates
#
# Documentation: https://aquasecurity.github.io/trivy/latest/docs/configuration/filtering/

# =============================================================================
# VULNERABILITY IGNORES
# =============================================================================
# Add CVEs to ignore below. Each entry should include:
# - CVE ID
# - Brief justification
# - Review date or ticket reference

{%- if ignored_cves is defined and ignored_cves %}
{% for cve in ignored_cves %}
# {{ cve.id }}: {{ cve.justification | default('No justification provided - REVIEW REQUIRED') }}
# Review date: {{ cve.review_date | default('ASAP') }}
{%- if cve.ticket is defined %}
# Ticket: {{ cve.ticket }}
{%- endif %}
{{ cve.id }}

{% endfor %}
{%- else %}
# Example entries (uncomment and modify as needed):
#
# CVE-2023-12345: False positive - affected code path not used in our application
# CVE-2023-12345
#
# CVE-2023-67890: Mitigated by network isolation - internal service only
# Review date: 2024-06-01
# Ticket: SEC-123
# CVE-2023-67890
{%- endif %}

# =============================================================================
# SECRET IGNORES
# =============================================================================
# Ignore specific files or patterns for secret scanning
# Use sparingly - prefer fixing false positives at the source

{%- if ignored_secrets is defined and ignored_secrets %}
{% for secret in ignored_secrets %}
# {{ secret.path }}: {{ secret.justification | default('No justification provided') }}
{{ secret.path }}
{% endfor %}
{%- else %}
# Example entries:
# testdata/fake-credentials.json: Test fixtures with dummy values
# testdata/fake-credentials.json
{%- endif %}

# =============================================================================
# MISCONFIGURATION IGNORES (if misconfig scanning enabled)
# =============================================================================
# Ignore specific misconfiguration check IDs

{%- if ignored_misconfigs is defined and ignored_misconfigs %}
{% for config in ignored_misconfigs %}
# {{ config.id }}: {{ config.justification | default('No justification provided') }}
{{ config.id }}
{% endfor %}
{%- else %}
# Example entries:
# AVD-DS-0002: Non-root user not applicable for this build container
# AVD-DS-0002
{%- endif %}

# =============================================================================
# REVIEW LOG
# =============================================================================
# Track when this file was last reviewed and by whom
#
# Last reviewed: {{ review_date | default('PENDING') }}
# Reviewed by: {{ reviewer | default('PENDING') }}
# Next review: {{ next_review | default('Schedule monthly review') }}
