{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://claude.ai/validation/config.schema.json",
  "title": "Validation Pipeline Config",
  "description": "Configuration schema for universal 14-dimension validation framework",
  "type": "object",
  "required": ["project_name", "domain", "smoke_tests"],
  "properties": {
    "project_name": {
      "type": "string",
      "description": "Project identifier used in generated code"
    },
    "domain": {
      "type": "string",
      "enum": ["trading", "workflow", "data", "general"],
      "description": "Domain type determines which extension templates are included"
    },
    "smoke_tests": {
      "type": "object",
      "description": "Configuration for smoke test generation",
      "properties": {
        "critical_imports": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Python import paths that must succeed",
          "default": []
        },
        "config_files": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Config files to validate exist and parse",
          "default": []
        },
        "external_services": {
          "type": "array",
          "items": { "type": "string" },
          "description": "External services to check connectivity (format: 'host:port')",
          "default": []
        }
      },
      "additionalProperties": false
    },
    "k8s": {
      "type": "object",
      "description": "Kubernetes deployment configuration",
      "properties": {
        "enabled": { "type": "boolean", "default": false },
        "namespace": { "type": "string", "default": "default" },
        "rollout_strategy": {
          "type": "string",
          "enum": ["canary", "blue-green", "rolling"],
          "default": "canary"
        }
      },
      "additionalProperties": false
    },
    "rollback_triggers": {
      "type": "array",
      "description": "Metrics that trigger automatic rollback",
      "items": {
        "type": "object",
        "required": ["metric", "threshold", "operator"],
        "properties": {
          "metric": { "type": "string" },
          "threshold": { "type": "number" },
          "operator": { "type": "string", "enum": ["<", ">", "==", "!=", "<=", ">="] }
        },
        "additionalProperties": false
      },
      "default": []
    },
    "ci": {
      "type": "object",
      "description": "CI/CD workflow configuration",
      "properties": {
        "smoke_timeout_minutes": { "type": "integer", "default": 5 },
        "test_timeout_minutes": { "type": "integer", "default": 10 },
        "python_version": { "type": "string", "default": "3.12" }
      },
      "additionalProperties": false
    },
    "dimensions": {
      "type": "object",
      "description": "14-dimension validation configuration",
      "properties": {
        "code_quality": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 1: Code style (ruff)" },
        "type_safety": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 1: Type checking (pyright)" },
        "security": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 1: Security scanning" },
        "coverage": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 1: Test coverage" },
        "design_principles": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 2: KISS/YAGNI/DRY" },
        "oss_reuse": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 2: Package suggestions" },
        "architecture": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 2: ARCHITECTURE.md" },
        "documentation": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 2: README.md" },
        "performance": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 3: Lighthouse" },
        "accessibility": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 3: axe-core" },
        "visual": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 3: Visual regression" },
        "mathematical": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 3: CAS validation" },
        "data_integrity": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 3: Schema validation" },
        "api_contract": { "$ref": "#/$defs/dimensionConfig", "description": "Tier 3: OpenAPI diff" }
      },
      "additionalProperties": false
    },
    "backpressure": {
      "type": "object",
      "description": "Ralph loop backpressure configuration",
      "properties": {
        "max_iterations": { "type": "integer", "default": 15 },
        "max_budget_usd": { "type": "number", "default": 20.0 },
        "tier1_max_failures": { "type": "integer", "default": 3 },
        "min_interval_seconds": { "type": "integer", "default": 10 }
      },
      "additionalProperties": false
    }
  },
  "$defs": {
    "dimensionConfig": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "tier": { "type": "integer", "enum": [1, 2, 3] },
        "agent": { "type": "string", "description": "Agent for auto-fix" },
        "threshold": { "type": "object" }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": false
}
