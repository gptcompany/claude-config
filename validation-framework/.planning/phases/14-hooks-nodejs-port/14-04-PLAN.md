---
phase: 14-hooks-nodejs-port
plan: 04
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - ~/.claude/hooks/hooks.json
autonomous: true
---

<objective>
Create the declarative hooks.json configuration that wires up all hooks.

Purpose: Central configuration for all hooks - easy to enable/disable/customize.
Output: `~/.claude/hooks/hooks.json` with all hook bindings (~150 lines)
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-hooks-nodejs-port/14-RESEARCH.md
@.planning/phases/14-hooks-nodejs-port/14-01-SUMMARY.md

# ECC Reference:
# /media/sam/1TB/everything-claude-code/hooks/hooks.json

# Our hooks (from 14-02 and 14-03):
# ~/.claude/scripts/hooks/session-start.js
# ~/.claude/scripts/hooks/session-end.js
# ~/.claude/scripts/hooks/pre-compact.js
# ~/.claude/scripts/hooks/suggest-compact.js
# ~/.claude/scripts/hooks/evaluate-session.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create hooks.json with session lifecycle hooks</name>
  <files>~/.claude/hooks/hooks.json</files>
  <action>
1. Create directory: `mkdir -p ~/.claude/hooks`
2. Create hooks.json with JSON schema reference
3. Add SessionStart hook:
   - matcher: "*"
   - command: "node ~/.claude/scripts/hooks/session-start.js"
   - description: "Load previous context and detect package manager"
4. Add SessionEnd hooks (two):
   - First: session-end.js - "Persist session state on end"
   - Second: evaluate-session.js - "Evaluate session for patterns"
5. Add PreCompact hook:
   - matcher: "*"
   - command: pre-compact.js
   - description: "Save state before context compaction"

Use absolute paths with $HOME expansion: `"node \"$HOME/.claude/scripts/hooks/session-start.js\""`
  </action>
  <verify>cat ~/.claude/hooks/hooks.json | jq '.hooks.SessionStart'</verify>
  <done>hooks.json exists with SessionStart, SessionEnd, PreCompact bindings</done>
</task>

<task type="auto">
  <name>Task 2: Add PreToolUse hooks</name>
  <files>~/.claude/hooks/hooks.json</files>
  <action>
1. Add PreToolUse hooks from ECC:
   - Dev server blocking (npm/pnpm/yarn/bun run dev must be in tmux)
   - Tmux reminder for long-running commands
   - Git push review reminder
   - Doc file blocking (prevent random .md creation)
   - Suggest compaction on Edit/Write
2. Use same matchers as ECC hooks.json
3. Inline hooks can use `node -e "..."` for simple logic
4. Complex hooks (suggest-compact) use external script

Preserve ECC's matcher patterns exactly - they're well-tested.
  </action>
  <verify>cat ~/.claude/hooks/hooks.json | jq '.hooks.PreToolUse | length'</verify>
  <done>PreToolUse array has 5 hook entries</done>
</task>

<task type="auto">
  <name>Task 3: Add PostToolUse and Stop hooks</name>
  <files>~/.claude/hooks/hooks.json</files>
  <action>
1. Add PostToolUse hooks from ECC:
   - PR URL logging after `gh pr create`
   - Prettier formatting after JS/TS edits
   - TypeScript check after .ts/.tsx edits
   - console.log warning after JS/TS edits
2. Add Stop hook:
   - Check for console.log in modified files after each response
3. All PostToolUse hooks pass through input (read stdin, process, write stdout)
4. Use inline `node -e` for these simple hooks (as ECC does)

These hooks provide immediate feedback during development.
  </action>
  <verify>cat ~/.claude/hooks/hooks.json | jq '.hooks.PostToolUse | length'</verify>
  <done>PostToolUse has 4 hooks, Stop has 1 hook</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `~/.claude/hooks/hooks.json` exists
- [ ] JSON is valid: `jq . ~/.claude/hooks/hooks.json`
- [ ] Has $schema reference for IDE support
- [ ] SessionStart: 1 hook
- [ ] SessionEnd: 2 hooks
- [ ] PreCompact: 1 hook
- [ ] PreToolUse: 5 hooks
- [ ] PostToolUse: 4 hooks
- [ ] Stop: 1 hook
- [ ] Total: 14 hook entries
</verification>

<success_criteria>

- hooks.json is valid JSON with schema reference
- All ECC hook events covered (SessionStart, SessionEnd, PreCompact, PreToolUse, PostToolUse, Stop)
- Hooks point to correct script paths
- Configuration is complete and ready for testing
</success_criteria>

<output>
After completion, create `.planning/phases/14-hooks-nodejs-port/14-04-SUMMARY.md`
</output>
