---
phase: 14-hooks-nodejs-port
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - ~/.claude/scripts/hooks/suggest-compact.js
  - ~/.claude/scripts/hooks/evaluate-session.js
autonomous: true
---

<objective>
Port ECC's development workflow hooks: suggest-compact and evaluate-session.

Purpose: Quality-of-life hooks for context management and pattern extraction.
Output: Two Node.js hook scripts (~140 LOC)
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-hooks-nodejs-port/14-RESEARCH.md
@.planning/phases/14-hooks-nodejs-port/14-01-SUMMARY.md

# ECC Reference (port from):
# /media/sam/1TB/everything-claude-code/scripts/hooks/suggest-compact.js (60 LOC)
# /media/sam/1TB/everything-claude-code/scripts/hooks/evaluate-session.js (78 LOC)

# Uses:
# ~/.claude/scripts/lib/utils.js (from 14-01)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Port suggest-compact.js</name>
  <files>~/.claude/scripts/hooks/suggest-compact.js</files>
  <action>
1. Port ECC's suggest-compact.js
2. Hook behavior (PreToolUse for Edit/Write):
   - Track edit count in session (via temp file or env)
   - Every N edits (e.g., 10), suggest manual compaction
   - Log: "[Hook] Consider /compact - [N] edits this session"
   - Pass through input unchanged (don't block)
3. This is a soft suggestion, not a blocker
4. Read input from stdin, write to stdout
5. Graceful degradation
  </action>
  <verify>echo '{"tool_name":"Edit","tool_input":{"file_path":"test.js"}}' | node ~/.claude/scripts/hooks/suggest-compact.js</verify>
  <done>suggest-compact.js runs, passes input through, optionally suggests compaction</done>
</task>

<task type="auto">
  <name>Task 2: Port evaluate-session.js</name>
  <files>~/.claude/scripts/hooks/evaluate-session.js</files>
  <action>
1. Port ECC's evaluate-session.js
2. Hook behavior (SessionEnd):
   - Analyze session for extractable patterns
   - Look for repeated commands, common file patterns
   - If patterns found, log suggestion to create learned skill
   - Save patterns to `~/.claude/sessions/patterns/`
3. This helps identify automation opportunities
4. Read session data from stdin
5. Graceful degradation - pattern extraction is best-effort
  </action>
  <verify>echo '{"messages":[]}' | node ~/.claude/scripts/hooks/evaluate-session.js</verify>
  <done>evaluate-session.js runs, analyzes input for patterns</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `~/.claude/scripts/hooks/suggest-compact.js` exists and runs
- [ ] `~/.claude/scripts/hooks/evaluate-session.js` exists and runs
- [ ] Both hooks pass through input (don't block workflow)
- [ ] Both hooks exit 0
</verification>

<success_criteria>

- suggest-compact.js tracks edits and suggests compaction
- evaluate-session.js analyzes sessions for patterns
- Both hooks are non-blocking
- Both use utils.js library
</success_criteria>

<output>
After completion, create `.planning/phases/14-hooks-nodejs-port/14-03-SUMMARY.md`
</output>
