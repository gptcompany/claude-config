---
phase: 14.5-hooks-shared-port
plan: 04
type: execute
wave: 2
depends_on: ["14.5-01"]
files_modified:
  - ~/.claude/scripts/hooks/quality/ci-autofix.js
  - ~/.claude/scripts/hooks/quality/plan-validator.js
  - ~/.claude/scripts/hooks/quality/pr-readiness.js
  - ~/.claude/scripts/hooks/quality/architecture-validator.js
  - ~/.claude/scripts/hooks/quality/readme-generator.js
autonomous: true
---

<objective>
Port quality hooks - CI, PR, and documentation quality.

Purpose: Automated quality gates and documentation updates
Output: 5 quality hook scripts (~900 LOC)
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/14.5-hooks-shared-port/14.5-RESEARCH.md
@.planning/phases/14.5-hooks-shared-port/14.5-01-SUMMARY.md

# Python sources to port:
# /media/sam/1TB/claude-hooks-shared/hooks/quality/ci-autofix.py (312 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/quality/plan_validator.py (189 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/quality/pr-readiness-check.py (234 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/productivity/architecture-validator.py (289 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/productivity/readme-generator.py (234 LOC)

# Uses:
# ~/.claude/scripts/lib/utils.js
# ~/.claude/scripts/lib/git-utils.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create quality directory and ci-autofix.js</name>
  <files>~/.claude/scripts/hooks/quality/ci-autofix.js</files>
  <action>
1. Create directory: `mkdir -p ~/.claude/scripts/hooks/quality`
2. Port ci-autofix.py
3. Hook behavior (PostToolUse for Bash when command = gh/git):
   - Detect CI failure from command output
   - Parse common failure patterns (lint, test, type errors)
   - Suggest auto-fix commands
4. Return `{"systemMessage": "CI failed: [reason]. Try: [fix command]"}`
  </action>
  <verify>echo '{"tool_name":"Bash","tool_output":"error: lint failed"}' | node ~/.claude/scripts/hooks/quality/ci-autofix.js</verify>
  <done>ci-autofix.js detects CI failures and suggests fixes</done>
</task>

<task type="auto">
  <name>Task 2: Create plan-validator.js</name>
  <files>~/.claude/scripts/hooks/quality/plan-validator.js</files>
  <action>
1. Port plan_validator.py
2. Hook behavior (PostToolUse for Write when file = *-PLAN.md):
   - Validate plan structure (frontmatter, tasks, verification)
   - Check required fields: phase, plan, type, wave
   - Validate task format
3. Return `{"systemMessage": "Plan validation: [issues]"}` if issues found
  </action>
  <verify>echo '{"tool_name":"Write","tool_input":{"file_path":"test-PLAN.md"}}' | node ~/.claude/scripts/hooks/quality/plan-validator.js</verify>
  <done>plan-validator.js validates GSD plan files</done>
</task>

<task type="auto">
  <name>Task 3: Create pr-readiness.js</name>
  <files>~/.claude/scripts/hooks/quality/pr-readiness.js</files>
  <action>
1. Port pr-readiness-check.py
2. Hook behavior (PreToolUse for Bash when command = gh pr):
   - Check tests pass locally
   - Check no uncommitted changes
   - Check branch is up to date with base
   - Check PR description template
3. Return `{"decision": "block", "reason": "..."}` if not ready
4. Return `{}` if all checks pass
  </action>
  <verify>echo '{"tool_name":"Bash","tool_input":{"command":"gh pr create"}}' | node ~/.claude/scripts/hooks/quality/pr-readiness.js</verify>
  <done>pr-readiness.js validates PR creation requirements</done>
</task>

<task type="auto">
  <name>Task 4: Create architecture-validator.js</name>
  <files>~/.claude/scripts/hooks/quality/architecture-validator.js</files>
  <action>
1. Port architecture-validator.py
2. Hook behavior (PostToolUse for Write/Edit):
   - Detect new components in code
   - Check if ARCHITECTURE.md exists
   - Compare with documented architecture
   - Auto-update ARCHITECTURE.md if new patterns detected
3. Trigger on new files in src/, lib/, components/
4. Return `{"systemMessage": "Updated ARCHITECTURE.md with new component"}`
  </action>
  <verify>echo '{"tool_name":"Write","tool_input":{"file_path":"src/new-component.js"}}' | node ~/.claude/scripts/hooks/quality/architecture-validator.js</verify>
  <done>architecture-validator.js updates architecture documentation</done>
</task>

<task type="auto">
  <name>Task 5: Create readme-generator.js</name>
  <files>~/.claude/scripts/hooks/quality/readme-generator.js</files>
  <action>
1. Port readme-generator.py
2. Hook behavior (PostToolUse for Write/Edit):
   - Detect significant code changes
   - Check README.md consistency
   - Auto-update README sections:
     - Installation (if package.json changes)
     - Usage (if exports change)
     - API (if public API changes)
3. Return `{"systemMessage": "Consider updating README.md: [section]"}`
  </action>
  <verify>echo '{"tool_name":"Edit","tool_input":{"file_path":"package.json"}}' | node ~/.claude/scripts/hooks/quality/readme-generator.js</verify>
  <done>readme-generator.js suggests README updates</done>
</task>

<task type="auto">
  <name>Task 6: Create quality tests</name>
  <files>~/.claude/scripts/hooks/quality/quality.test.js</files>
  <action>
1. Test each quality hook:
   - ci-autofix: failure detection, fix suggestions
   - plan-validator: structure validation
   - pr-readiness: prerequisite checks
   - architecture-validator: pattern detection
   - readme-generator: change detection
2. Minimum 15 tests (3 per hook)
  </action>
  <verify>node --test ~/.claude/scripts/hooks/quality/quality.test.js</verify>
  <done>All quality tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 5 quality hooks exist and run without error
- [ ] ci-autofix detects failures
- [ ] plan-validator validates structure
- [ ] pr-readiness checks prerequisites
- [ ] architecture-validator detects patterns
- [ ] readme-generator suggests updates
- [ ] 15+ tests pass
</verification>

<success_criteria>
- 5 quality hooks ported to Node.js
- All hooks produce valid output
- 15+ tests passing
</success_criteria>

<output>
After completion, create `.planning/phases/14.5-hooks-shared-port/14.5-04-SUMMARY.md`
</output>
