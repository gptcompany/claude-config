---
phase: 14.5-hooks-shared-port
plan: 05
type: execute
wave: 3
depends_on: ["14.5-01"]
files_modified:
  - ~/.claude/scripts/hooks/productivity/auto-format.js
  - ~/.claude/scripts/hooks/productivity/tdd-guard.js
  - ~/.claude/scripts/hooks/productivity/task-checkpoint.js
  - ~/.claude/scripts/hooks/productivity/auto-simplify.js
autonomous: true
---

<objective>
Port productivity hooks - formatting, TDD, and task management.

Purpose: Developer productivity automation
Output: 4 productivity hook scripts (~800 LOC)
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/14.5-hooks-shared-port/14.5-RESEARCH.md
@.planning/phases/14.5-hooks-shared-port/14.5-01-SUMMARY.md

# Python sources to port:
# /media/sam/1TB/claude-hooks-shared/hooks/productivity/auto-format.py (156 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/productivity/tdd-guard-check.py (201 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/productivity/task-auto-checkpoint.py (167 LOC)
# /media/sam/1TB/claude-hooks-shared/hooks/productivity/auto-simplify-check.py (178 LOC)

# Uses:
# ~/.claude/scripts/lib/utils.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create productivity directory and auto-format.js</name>
  <files>~/.claude/scripts/hooks/productivity/auto-format.js</files>
  <action>
1. Create directory: `mkdir -p ~/.claude/scripts/hooks/productivity`
2. Port auto-format.py
3. Hook behavior (PostToolUse for Write/Edit on .js/.ts/.tsx/.jsx):
   - Detect code file changes
   - Run prettier if available
   - Run eslint --fix if available
   - Report formatting applied
4. Use child_process.execSync with timeout
5. Return `{"systemMessage": "Auto-formatted [file]"}` if changes made
  </action>
  <verify>echo '{"tool_name":"Write","tool_input":{"file_path":"test.js"}}' | node ~/.claude/scripts/hooks/productivity/auto-format.js</verify>
  <done>auto-format.js runs formatters on code files</done>
</task>

<task type="auto">
  <name>Task 2: Create tdd-guard.js</name>
  <files>~/.claude/scripts/hooks/productivity/tdd-guard.js</files>
  <action>
1. Port tdd-guard-check.py
2. Hook behavior (PreToolUse for Write/Edit):
   - Track if tests exist for modified file
   - Check test file naming convention (*.test.js, *.spec.js)
   - Warn if implementation changed without corresponding test
3. Guard modes:
   - strict: block changes without tests
   - warn: suggest tests
   - off: disabled
4. Mode configured via ~/.claude/tdd-config.json
5. Return `{"decision": "warn", "message": "Consider adding tests for [file]"}`
  </action>
  <verify>echo '{"tool_name":"Edit","tool_input":{"file_path":"src/util.js"}}' | node ~/.claude/scripts/hooks/productivity/tdd-guard.js</verify>
  <done>tdd-guard.js enforces TDD discipline</done>
</task>

<task type="auto">
  <name>Task 3: Create task-checkpoint.js</name>
  <files>~/.claude/scripts/hooks/productivity/task-checkpoint.js</files>
  <action>
1. Port task-auto-checkpoint.py
2. Hook behavior (PostToolUse):
   - Track task progress during execution
   - Auto-checkpoint after N successful tool calls
   - Save checkpoint to ~/.claude/checkpoints/
3. Checkpoint data:
   - Task description
   - Files modified
   - Git state
   - Timestamp
4. Used for crash recovery and progress tracking
  </action>
  <verify>echo '{"tool_name":"Edit"}' | node ~/.claude/scripts/hooks/productivity/task-checkpoint.js</verify>
  <done>task-checkpoint.js creates progress checkpoints</done>
</task>

<task type="auto">
  <name>Task 4: Create auto-simplify.js</name>
  <files>~/.claude/scripts/hooks/productivity/auto-simplify.js</files>
  <action>
1. Port auto-simplify-check.py
2. Hook behavior (PostToolUse for Write/Edit):
   - Analyze code complexity indicators:
     - Function length > 50 lines
     - Nesting depth > 4
     - Parameter count > 5
   - Suggest simplification when thresholds exceeded
3. Return `{"systemMessage": "Consider simplifying [function]: [reason]"}`
4. Only analyze recently changed code
  </action>
  <verify>echo '{"tool_name":"Write","tool_input":{"file_path":"src/complex.js"}}' | node ~/.claude/scripts/hooks/productivity/auto-simplify.js</verify>
  <done>auto-simplify.js suggests code simplification</done>
</task>

<task type="auto">
  <name>Task 5: Create productivity tests</name>
  <files>~/.claude/scripts/hooks/productivity/productivity.test.js</files>
  <action>
1. Test each productivity hook:
   - auto-format: formatter detection, file type filtering
   - tdd-guard: test file matching, mode configuration
   - task-checkpoint: checkpoint creation
   - auto-simplify: complexity detection
2. Minimum 12 tests (3 per hook)
  </action>
  <verify>node --test ~/.claude/scripts/hooks/productivity/productivity.test.js</verify>
  <done>All productivity tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 4 productivity hooks exist and run without error
- [ ] auto-format runs on code files
- [ ] tdd-guard checks for tests
- [ ] task-checkpoint creates checkpoints
- [ ] auto-simplify analyzes complexity
- [ ] 12+ tests pass
</verification>

<success_criteria>
- 4 productivity hooks ported to Node.js
- All hooks produce valid output
- 12+ tests passing
</success_criteria>

<output>
After completion, create `.planning/phases/14.5-hooks-shared-port/14.5-05-SUMMARY.md`
</output>
