---
phase: 18-validator-depth
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.claude/templates/validation/orchestrator.py
  - ~/.claude/templates/validation/orchestrator.py.j2
  - ~/.claude/templates/validation/tests/test_orchestrator.py
autonomous: true
---

<objective>
Wire existing VisualTargetValidator and BehavioralValidator into the ValidationOrchestrator.

Purpose: The validators exist and have 148 tests passing, but they're not connected to the orchestrator. This plan bridges that gap.
Output: Both validators registered in VALIDATOR_REGISTRY and available via config.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-validator-depth/18-CONTEXT.md

# Source files
@~/.claude/templates/validation/orchestrator.py
@~/.claude/templates/validation/validators/visual/__init__.py
@~/.claude/templates/validation/validators/behavioral/__init__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add imports for visual and behavioral validators</name>
  <files>~/.claude/templates/validation/orchestrator.py, ~/.claude/templates/validation/orchestrator.py.j2</files>
  <action>
Add try/except import blocks for VisualTargetValidator and BehavioralValidator following the existing pattern (like ECC validators).

Import from:
- `from validators.visual import VisualTargetValidator`
- `from validators.behavioral import BehavioralValidator`

Use try/except to set VISUAL_VALIDATOR_AVAILABLE and BEHAVIORAL_VALIDATOR_AVAILABLE flags for graceful fallback.

Place imports after the ECC validator imports (around line 500-520).

Update both orchestrator.py and orchestrator.py.j2 (the template).
  </action>
  <verify>python -c "from orchestrator import VisualTargetValidator, BehavioralValidator" works without error</verify>
  <done>Both validators importable from orchestrator module</done>
</task>

<task type="auto">
  <name>Task 2: Register validators in VALIDATOR_REGISTRY</name>
  <files>~/.claude/templates/validation/orchestrator.py, ~/.claude/templates/validation/orchestrator.py.j2</files>
  <action>
Update VALIDATOR_REGISTRY to use real validators instead of stubs:

1. Change line 963 from `"visual": BaseValidator` to `"visual": VisualTargetValidator`
2. Add `"behavioral": BehavioralValidator` entry (currently missing)

Use conditional registration (like ECC validators) based on VISUAL_VALIDATOR_AVAILABLE and BEHAVIORAL_VALIDATOR_AVAILABLE flags.

Add to default dimensions in _register_validators():
```python
"visual": {"enabled": True, "tier": 3},
"behavioral": {"enabled": True, "tier": 3},
```

Update both orchestrator.py and orchestrator.py.j2.
  </action>
  <verify>python -c "from orchestrator import ValidationOrchestrator; o = ValidationOrchestrator(); print('visual' in o.VALIDATOR_REGISTRY, 'behavioral' in o.VALIDATOR_REGISTRY)"</verify>
  <done>Both validators in registry and default dimensions</done>
</task>

<task type="auto">
  <name>Task 3: Add orchestrator integration tests</name>
  <files>~/.claude/templates/validation/tests/test_orchestrator.py</files>
  <action>
Add test class TestVisualBehavioralIntegration with tests:

1. test_visual_validator_registered - verify VisualTargetValidator is in VALIDATOR_REGISTRY (not BaseValidator)
2. test_behavioral_validator_registered - verify BehavioralValidator is in VALIDATOR_REGISTRY
3. test_visual_in_default_dimensions - verify visual enabled at tier 3 by default
4. test_behavioral_in_default_dimensions - verify behavioral enabled at tier 3 by default
5. test_validators_instantiated_with_config - verify validators accept config from dimensions config
6. test_graceful_fallback_when_unavailable - mock import failure, verify BaseValidator used as fallback

Follow existing test patterns in the file (pytest.mark.asyncio, fixtures, etc.).
  </action>
  <verify>cd ~/.claude/templates/validation && python -m pytest tests/test_orchestrator.py::TestVisualBehavioralIntegration -v</verify>
  <done>6 new integration tests passing</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `python -c "from orchestrator import ValidationOrchestrator"` succeeds
- [ ] `python -m pytest tests/test_orchestrator.py -v` passes (existing + new tests)
- [ ] `python -m pytest validators/visual/tests/ validators/behavioral/tests/ -v` still passes (148 tests)
- [ ] Instantiating ValidationOrchestrator includes visual and behavioral validators by default
</verification>

<success_criteria>

- VisualTargetValidator registered in VALIDATOR_REGISTRY (not BaseValidator)
- BehavioralValidator registered in VALIDATOR_REGISTRY
- Both validators in default dimensions at Tier 3
- Graceful fallback to BaseValidator if import fails
- 6 new integration tests passing
- All existing tests (367+) still passing
</success_criteria>

<output>
After completion, create `.planning/phases/18-validator-depth/18-01-SUMMARY.md`
</output>
