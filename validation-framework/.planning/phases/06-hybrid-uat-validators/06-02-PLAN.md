---
phase: 06-hybrid-uat-validators
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.claude/templates/validation/validators/accessibility/axe.config.js.j2
  - ~/.claude/templates/validation/validators/accessibility/test_a11y.spec.ts.j2
  - ~/.claude/templates/validation/ci/accessibility.yml.j2
autonomous: true
---

<objective>
Create accessibility validation templates using axe-core with Playwright.

Purpose: Enable WCAG 2.1 AA compliance checking in CI/CD pipelines.
Output: Jinja2 templates for axe-core config, Playwright a11y tests, and GitHub Actions workflow.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-hybrid-uat-validators/06-RESEARCH.md
@~/.claude/templates/validation/config.schema.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create axe-core configuration template</name>
  <files>~/.claude/templates/validation/validators/accessibility/axe.config.js.j2</files>
  <action>
Create a Jinja2 template for axe-core configuration:
1. Define WCAG tags to check: wcag2a, wcag2aa, wcag21a, wcag21aa
2. Configure rules to disable (if any) with justification comments
3. Define element excludes for third-party widgets
4. Set up reporter options

Include Jinja2 variables for:
- {{ project_name }}
- {{ wcag_level | default('wcag21aa') }}
- {{ excluded_selectors | default([]) }}
- {{ disabled_rules | default([]) }}

Follow research pattern: Use axe.configure() to disable specific rules when justified.
Export module for use in Playwright tests.
  </action>
  <verify>node -c ~/.claude/templates/validation/validators/accessibility/axe.config.js.j2 2>&1 | grep -v "SyntaxError" || true</verify>
  <done>Template contains valid axe-core configuration with Jinja2 variables</done>
</task>

<task type="auto">
  <name>Task 2: Create Playwright accessibility test template</name>
  <files>~/.claude/templates/validation/validators/accessibility/test_a11y.spec.ts.j2</files>
  <action>
Create a Jinja2 template for Playwright + axe-core tests:
1. Import @axe-core/playwright AxeBuilder
2. Import axe config from axe.config.js
3. Create test suite with page-level a11y checks
4. For each page:
   - Navigate to page
   - Run AxeBuilder with configured tags
   - Exclude configured selectors
   - Assert zero violations
   - On failure, log detailed violation info

Include Jinja2 variables for:
- {{ project_name }}
- {{ pages | default(['/']) }}
- {{ timeout | default(30000) }}

Follow research example from playwright.dev/docs/accessibility-testing.
Include detailed failure output with JSON.stringify for debugging.
  </action>
  <verify>echo "Template created - TypeScript syntax checked during render"</verify>
  <done>Template contains valid Playwright test with axe-core integration</done>
</task>

<task type="auto">
  <name>Task 3: Create accessibility CI workflow template</name>
  <files>~/.claude/templates/validation/ci/accessibility.yml.j2</files>
  <action>
Create a Jinja2 template for GitHub Actions accessibility workflow:
1. Trigger on push/PR to main/develop
2. Setup Node.js with caching
3. Install dependencies including @axe-core/playwright
4. Start dev server (if needed for pages)
5. Run Playwright a11y tests
6. Generate axe-html-reporter output
7. Upload a11y report as artifact
8. Fail workflow on WCAG violations

Include Jinja2 variables for:
- {{ project_name }}
- {{ node_version | default('20') }}
- {{ start_command | default('npm run dev') }}
- {{ test_command | default('npx playwright test --project=accessibility') }}

Set exit-code behavior to fail on violations (blocking PR).
Use proper GitHub Actions patterns from existing ci/ templates.
  </action>
  <verify>python3 -c "import yaml; yaml.safe_load(open('~/.claude/templates/validation/ci/accessibility.yml.j2').read().replace('{{', '').replace('}}', '').replace('{%', '').replace('%}', ''))"</verify>
  <done>Template contains valid GitHub Actions workflow YAML</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] axe.config.js.j2 created with WCAG configuration
- [ ] test_a11y.spec.ts.j2 created with Playwright tests
- [ ] accessibility.yml.j2 created with CI workflow
- [ ] All templates are valid Jinja2
</verification>

<success_criteria>

- All tasks completed
- Templates follow patterns from research
- CI workflow blocks PRs on a11y violations
- No errors or warnings introduced
</success_criteria>

<output>
After completion, create `.planning/phases/06-hybrid-uat-validators/06-02-SUMMARY.md`
</output>
