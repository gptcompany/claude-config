---
phase: 14.6-hooks-integration-validation
plan: 04
type: execute
wave: 2
depends_on: ["14.6-01", "14.6-02"]
files_modified:
  - ~/.claude/docs/HOOKS-CATALOG.md
  - ~/.claude/docs/HOOKS-TROUBLESHOOTING.md
  - ~/.claude/docs/HOOKS-PERFORMANCE.md
  - ~/.claude/scripts/hooks/generate-docs.js
  - ~/.claude/scripts/hooks/final-validation.js
autonomous: false
---

<objective>
Create comprehensive documentation and diagnostic tools.

Purpose: Enable easy troubleshooting and maintenance
Output: Complete hook documentation + diagnostic tools
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/14.6-hooks-integration-validation/14.6-RESEARCH.md

# Documentation requirements:
# - Every hook documented
# - Common issues addressed
# - Performance tuning guide
# - Auto-generated from code
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create hooks catalog</name>
  <files>~/.claude/docs/HOOKS-CATALOG.md</files>
  <action>
1. Create directory: `mkdir -p ~/.claude/docs`
2. Document every hook:

   Format per hook:
   ```markdown
   ## git-safety-check

   **Event:** PreToolUse
   **Path:** ~/.claude/scripts/hooks/safety/git-safety-check.js
   **Purpose:** Block destructive git commands

   ### Input
   ```json
   {"tool_name": "Bash", "tool_input": {"command": "..."}}
   ```

   ### Output
   - Allow: `{}`
   - Block: `{"decision": "block", "reason": "..."}`

   ### Configuration
   - None

   ### Examples
   - Blocked: `git push --force origin main`
   - Allowed: `git status`
   ```

3. Organize by category:
   - Core & Safety
   - Intelligence & Session
   - Quality & Productivity
   - Metrics & Coordination
   - UX & Control
   - Debug
  </action>
  <verify>test -f ~/.claude/docs/HOOKS-CATALOG.md && wc -l ~/.claude/docs/HOOKS-CATALOG.md</verify>
  <done>HOOKS-CATALOG.md documents all 40+ hooks</done>
</task>

<task type="auto">
  <name>Task 2: Create troubleshooting guide</name>
  <files>~/.claude/docs/HOOKS-TROUBLESHOOTING.md</files>
  <action>
1. Common issues and solutions:

   a. Hook not firing:
      - Check hooks.json syntax
      - Verify path exists
      - Check enabled flag
      - Run: `node hooks-cli.js status`

   b. Hook blocking unexpectedly:
      - Check debug log
      - Verify input format
      - Test manually: `echo '{}' | node hook.js`

   c. Performance issues:
      - Run benchmarks
      - Check memory usage
      - Look for loops/network calls

   d. State corruption:
      - Check state files
      - Reset with: `node hooks-cli.js reset`
      - Verify JSON syntax

   e. Integration failures:
      - Check Phase 13 components
      - Verify file paths
      - Run regression tests

2. Diagnostic commands:
   ```bash
   # Check all hooks
   node hooks-cli.js status

   # Test specific hook
   node hooks-cli.js test git-safety-check

   # View recent logs
   node hooks-cli.js log --last 20

   # Full validation
   node test-all-hooks.js

   # Performance check
   node hook-benchmarks.js
   ```

3. Error codes and meanings
  </action>
  <verify>test -f ~/.claude/docs/HOOKS-TROUBLESHOOTING.md</verify>
  <done>HOOKS-TROUBLESHOOTING.md covers common issues</done>
</task>

<task type="auto">
  <name>Task 3: Create performance tuning guide</name>
  <files>~/.claude/docs/HOOKS-PERFORMANCE.md</files>
  <action>
1. Performance optimization guide:

   a. Hook execution time:
      - Avoid synchronous I/O
      - Cache file reads
      - Minimize child processes

   b. Memory optimization:
      - Stream large files
      - Limit state size
      - Clean up temp files

   c. Configuration tuning:
      - Disable unused hooks
      - Adjust thresholds
      - Configure timeouts

   d. Monitoring:
      - Enable tracing
      - Check health status
      - Review metrics

2. Benchmarks and targets:
   | Metric | Target | Critical |
   |--------|--------|----------|
   | p95 latency | < 100ms | > 500ms |
   | Memory | < 50MB | > 200MB |
   | Error rate | < 1% | > 5% |

3. Scaling considerations
  </action>
  <verify>test -f ~/.claude/docs/HOOKS-PERFORMANCE.md</verify>
  <done>HOOKS-PERFORMANCE.md provides tuning guidance</done>
</task>

<task type="auto">
  <name>Task 4: Create documentation generator</name>
  <files>~/.claude/scripts/hooks/generate-docs.js</files>
  <action>
1. Auto-generate documentation from hooks:
   - Parse hook files for JSDoc comments
   - Extract input/output schemas
   - Generate markdown

2. Usage:
   ```bash
   # Generate all docs
   node generate-docs.js

   # Generate for specific hook
   node generate-docs.js --hook git-safety-check

   # Update catalog
   node generate-docs.js --update-catalog
   ```

3. JSDoc format in hooks:
   ```javascript
   /**
    * @hook git-safety-check
    * @event PreToolUse
    * @purpose Block destructive git commands
    * @input {Object} input - Hook input
    * @input {string} input.tool_name - Tool being used
    * @output {Object} output - Hook output
    * @output {string} [output.decision] - 'block' or 'allow'
    */
   ```

4. Validate docs are up to date
  </action>
  <verify>node ~/.claude/scripts/hooks/generate-docs.js --dry-run</verify>
  <done>generate-docs.js auto-generates documentation</done>
</task>

<task type="auto">
  <name>Task 5: Create final validation report</name>
  <files>~/.claude/scripts/hooks/final-validation.js</files>
  <action>
1. Create comprehensive validation report:
   - Run all test suites
   - Aggregate results
   - Calculate confidence score

2. Output:
   ```
   ═══════════════════════════════════════════════
   HOOKS VALIDATION REPORT
   ═══════════════════════════════════════════════

   Total Hooks: 40
   Documented: 40 (100%)

   TEST RESULTS
   ───────────────────────────────────────────────
   Unit Tests:        152/152 (100%)
   Integration Tests:  90/90  (100%)
   Regression Tests:   59/59  (100%)
   Reliability Tests:  43/43  (100%)
   Effectiveness:      50/50  (100%)
   ───────────────────────────────────────────────
   Total:            394/394 (100%)

   PERFORMANCE
   ───────────────────────────────────────────────
   p95 Latency:    45ms (target: <100ms) ✓
   Memory:         32MB (target: <50MB)  ✓
   Error Rate:     0.1% (target: <1%)    ✓

   CONFIDENCE SCORE: 98.5% ✓

   Status: READY FOR PRODUCTION
   ═══════════════════════════════════════════════
   ```

3. Exit code 0 if confidence >= 95%, else 1
  </action>
  <verify>node ~/.claude/scripts/hooks/final-validation.js --dry-run</verify>
  <done>final-validation.js produces comprehensive report</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] HOOKS-CATALOG.md documents all 40+ hooks
- [ ] HOOKS-TROUBLESHOOTING.md covers common issues
- [ ] HOOKS-PERFORMANCE.md provides tuning guidance
- [ ] generate-docs.js auto-generates documentation
- [ ] final-validation.js reports >= 95% confidence
</verification>

<success_criteria>
- Every hook fully documented
- Troubleshooting guide comprehensive
- Performance tuning guide complete
- Auto-generation of docs works
- Final validation achieves 95%+ confidence
</success_criteria>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete hooks system with:
- 37+ hooks across 10 categories
- ~392+ tests (unit + effectiveness + E2E + regression + performance)
- 3 documentation files (catalog, troubleshooting, performance)
- Final validation script with confidence report
  </what-built>
  <how-to-verify>
1. Run final validation:
   ```bash
   node ~/.claude/scripts/hooks/final-validation.js
   ```

2. Verify 95%+ pass rate in output

3. Spot check documentation:
   - Open ~/.claude/docs/HOOKS-CATALOG.md - all hooks listed?
   - Open ~/.claude/docs/HOOKS-TROUBLESHOOTING.md - commands work?
   - Open ~/.claude/docs/HOOKS-PERFORMANCE.md - baselines recorded?

4. Test a hook manually:
   ```bash
   echo '{"tool":"Bash","tool_input":{"command":"git push --force main"}}' | \
     node ~/.claude/scripts/hooks/safety/git-safety-check.js
   ```
   Should block with warning.
  </how-to-verify>
  <resume-signal>Type "approved" if 95%+ pass rate achieved and docs complete, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] HOOKS-CATALOG.md documents all 37+ hooks
- [ ] HOOKS-TROUBLESHOOTING.md covers common issues
- [ ] HOOKS-PERFORMANCE.md provides tuning guidance
- [ ] generate-docs.js auto-generates documentation
- [ ] final-validation.js reports >= 95% confidence
- [ ] Human verification approved
</verification>

<success_criteria>
- Every hook fully documented
- Troubleshooting guide comprehensive
- Performance tuning guide complete
- Auto-generation of docs works
- Final validation achieves 95%+ confidence
- Human verification approved
</success_criteria>

<output>
After completion, create `.planning/phases/14.6-hooks-integration-validation/14.6-04-SUMMARY.md`
</output>
